# Router Classification Test Cases
# Tests that queries are classified to the correct agent
# Coverage: 15 test cases across 5 agent types

description: "Router classification accuracy tests"

tests:
  # =============================================================================
  # SIMPLE-AGENT: Quick Q&A, no tools needed (3 tests)
  # =============================================================================

  - name: "Simple query - geography factual question"
    vars:
      query: "What is the capital of France?"
    assert:
      - type: javascript
        value: file://../assertions/routing-accuracy.ts:routesToAgent
        config:
          expectedAgent: "simple-agent"

  - name: "Simple query - arithmetic calculation"
    vars:
      query: "Calculate 15 times 23"
    assert:
      - type: javascript
        value: file://../assertions/routing-accuracy.ts:routesToAgent
        config:
          expectedAgent: "simple-agent"

  - name: "Simple query - creative request"
    vars:
      query: "Tell me a joke"
    assert:
      - type: javascript
        value: file://../assertions/routing-accuracy.ts:routesToAgent
        config:
          expectedAgent: "simple-agent"

  # =============================================================================
  # ORCHESTRATOR-AGENT: Complex tasks, code, architecture (3 tests)
  # =============================================================================

  - name: "Complex code task - authentication refactor"
    vars:
      query: "Refactor the authentication module to use JWT tokens and add refresh token support"
    assert:
      - type: javascript
        value: file://../assertions/routing-accuracy.ts:routesToAgent
        config:
          expectedAgent: "orchestrator-agent"

  - name: "Complex debugging - production issue investigation"
    vars:
      query: "Debug why the API returns 500 errors intermittently in production"
    assert:
      - type: javascript
        value: file://../assertions/routing-accuracy.ts:routesToAgent
        config:
          expectedAgent: "orchestrator-agent"

  - name: "Complex migration - TypeScript adoption"
    vars:
      query: "Add TypeScript support to the Express server and update all routes"
    assert:
      - type: javascript
        value: file://../assertions/routing-accuracy.ts:routesToAgent
        config:
          expectedAgent: "orchestrator-agent"

  # =============================================================================
  # LEAD-RESEARCHER-AGENT: Research, news, web search (3 tests)
  # =============================================================================

  - name: "Research query - AI industry trends"
    vars:
      query: "What are the latest developments in AI agents in 2024?"
    assert:
      - type: javascript
        value: file://../assertions/routing-accuracy.ts:routesToAgent
        config:
          expectedAgent: "lead-researcher-agent"

  - name: "Research query - technology comparison"
    vars:
      query: "Compare React Server Components vs Next.js App Router performance"
    assert:
      - type: javascript
        value: file://../assertions/routing-accuracy.ts:routesToAgent
        config:
          expectedAgent: "lead-researcher-agent"

  - name: "Research query - security best practices"
    vars:
      query: "Find best practices for securing Cloudflare Workers applications"
    assert:
      - type: javascript
        value: file://../assertions/routing-accuracy.ts:routesToAgent
        config:
          expectedAgent: "lead-researcher-agent"

  # =============================================================================
  # ORCHESTRATOR-AGENT: GitHub operations (2 tests)
  # =============================================================================

  - name: "GitHub operation - pull request creation"
    vars:
      query: "Create a PR to merge feature-auth branch into main"
    assert:
      - type: javascript
        value: file://../assertions/routing-accuracy.ts:routesToAgent
        config:
          expectedAgent: "orchestrator-agent"

  - name: "GitHub operation - code review"
    vars:
      query: "Review pull request #42 and suggest improvements"
    assert:
      - type: javascript
        value: file://../assertions/routing-accuracy.ts:routesToAgent
        config:
          expectedAgent: "orchestrator-agent"

  # =============================================================================
  # DUYET-INFO-AGENT: Personal information about Duyet (2 tests)
  # =============================================================================

  - name: "Personal info - contact details"
    vars:
      query: "What is Duyet's email address?"
    assert:
      - type: javascript
        value: file://../assertions/routing-accuracy.ts:routesToAgent
        config:
          expectedAgent: "duyet-info-agent"

  - name: "Personal info - professional details"
    vars:
      query: "Where does Duyet work and what does he do?"
    assert:
      - type: javascript
        value: file://../assertions/routing-accuracy.ts:routesToAgent
        config:
          expectedAgent: "duyet-info-agent"

  # =============================================================================
  # EDGE CASES (2 tests)
  # =============================================================================

  - name: "Edge case - minimal input"
    vars:
      query: "Hi"
    assert:
      - type: javascript
        value: file://../assertions/routing-accuracy.ts:routesToAgent
        config:
          expectedAgent: "simple-agent"

  - name: "Edge case - multi-domain complex task"
    vars:
      query: "Write a function to parse markdown AND research the best parsing algorithms"
    assert:
      - type: javascript
        value: file://../assertions/routing-accuracy.ts:routesToAgent
        config:
          expectedAgent: "orchestrator-agent"
